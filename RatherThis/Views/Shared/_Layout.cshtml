@using RatherThis.Code

<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.4.4.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftAjax.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftMvcAjax.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/MicrosoftMvcValidation.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.17.custom.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.infieldlabel.min.js")" type="text/javascript"></script>

    <script src="@Url.Content("~/Scripts/global.js")" type="text/javascript"></script>
</head>

<body>
    <div class="page">
        <div class="left-column">
            <div id="title">
                <a href="/"><img src="/images/logo.png" alt="RatherThis - Would you rather questions" /></a>
            </div>

            <div>
            @if (!Utility.IsAuthenticated())
            {
                <a href="javascript:void(0);" onclick="toggleRegistration()" class="left-nav-link">REGISTER</a>
                <div id="registration" class="left-column-form" style="display:none;">
                    @{ Html.RenderAction("Register", "Account"); }
                </div>
                
                <a href="javascript:void(0);" onclick="toggleLogin()" class="left-nav-link">LOGIN</a>
                <div id="login" class="left-column-form">
                    @{ Html.RenderAction("LogOn", "Account"); }
                </div>
            }
            else
            {
                <a href="javascript:void(0);" onclick="toggleUserInfo()" class="left-nav-link">MY INFO</a>
                <div id="user-info" class="left-column-form">
                    @{ Html.RenderAction("UserSummary", "Account"); }
                </div>
                <a href="javascript:void(0);" onclick="toggleNewQuestion()" class="left-nav-link">NEW QUESTION</a>
                <div id="new-question" class="left-column-form">
                    @{ Html.RenderAction("New", "Question"); }
                </div>
                <a href="@Url.Action("LogOff", "Account")" class="left-nav-link">LOG OUT</a>
            }

            <ul class="footer-nav">
                <li><a href="">About</a></li>
                <li><a href="">Privacy</a></li>
                <li><a href="">Terms</a></li>
                <li><a href="">Contact Us</a></li>
            </ul>
            </div>

        </div>
        
        <div class="main-column">
            <div id="menucontainer">
                @{ 
                    var topViewedSort = RatherThis.Code.Constants.QuestionSort.TOP_VIEWED.ToString().ToLower();
                    var genderFemale = RatherThis.Code.Constants.Gender.F.ToString().ToLower();
                    var genderMale = RatherThis.Code.Constants.Gender.M.ToString().ToLower();
                }
                <ul id="menu">
                    @{
                        var latestUrl = Url.Action("Index", "Question").ToLower();
                        var topViewedUrl = Url.Action("Index", "Question", new { sort = topViewedSort }, null).ToLower();
                        var ladiesUrl = Url.Action("Index", "Question", new { gender = genderFemale }, null).ToLower();
                        var guysUrl = Url.Action("Index", "Question", new { gender = genderMale }, null).ToLower();

                        var latestClass = "";
                        var topViewedClass = "";
                        var ladiesClass = "";
                        var guysClass = "";

                        var currentUrl = Request.Url.PathAndQuery.ToString().ToLower();
                        var pageQueryIndex = currentUrl.IndexOf("page=");
                        
                        currentUrl = pageQueryIndex > 0 ? currentUrl.Substring(0, pageQueryIndex - 1) : currentUrl;
                        if (latestUrl == currentUrl)
                        {
                            latestClass = "current";
                        }
                        if (topViewedUrl == currentUrl)
                        {
                            topViewedClass = "current";
                        }
                        if (ladiesUrl == currentUrl)
                        {
                            ladiesClass = "current";
                        }
                        if (guysUrl == currentUrl)
                        {
                            guysClass = "current";
                        }
                    }
                    <li><a href="@latestUrl" class="@latestClass">LATEST</a></li>
                    <li><a href="@topViewedUrl" class="@topViewedClass">TOP VIEWED</a></li>
                    <li><a href="@ladiesUrl" class="@ladiesClass">FOR THE LADIES</a></li>
                    <li><a href="@guysUrl" class="@guysClass">FOR THE GUYS</a></li>
                </ul>
            </div>
            <div id="main" class="clear">
                @RenderBody()

                <div class="clear"></div>
            </div>
            
        </div>

        <div id="footer clear">
            
        </div>
    </div>
</body>
</html>
